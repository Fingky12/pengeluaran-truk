<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Aplikasi Pengeluaran Truk</title>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="style.css" />
</head>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
<script>
  const firebaseConfig = {
    apiKey: "AIzaSyDrWaLNPVO03AERsRXgRF2BGnrasZoSotk",
    authDomain: "pengeluaran-truk.firebaseapp.com",
    projectId: "pengeluaran-truk",
    storageBucket: "pengeluaran-truk.appspot.com",
    messagingSenderId: "734887345473",
    appId: "1:734887345473:android:77c682f3a682ed6a9575c0"
  };

  // Inisialisasi Firebase
  firebase.initializeApp(firebaseConfig);
</script>
<body>
  <h2>ğŸšš Aplikasi Pengeluaran Truk</h2>

<div id="loginForm">
  <h3>ğŸ” Login Admin</h3>
  <input type="email" id="emailLogin" placeholder="Email Admin">
  <input type="password" id="passwordLogin" placeholder="Password">
  <button onclick="loginAdmin()">Login</button>
</div>

<button onclick="logoutAdmin()" id="logoutBtn" style="display:none; background:#e74c3c; color:#fff; margin-top:10px;">Logout</button>

  <!-- Form Tambah Barang ke Stok -->
  <section>
    <h3>â• Tambah Barang ke Stok</h3>
    <input id="kategoriBarang" placeholder="Kategori (Ban/Oli/Sparepart)" />
    <input id="namaBarang" placeholder="Nama Barang" />
    <select id="kondisiBarang">
      <option>Baru</option>
      <option>Bekas</option>
    </select>
    <input id="hargaBarang" placeholder="Harga Satuan" type="number" />
    <input id="jumlahBarang" placeholder="Jumlah" type="number" />
    <button onclick="tambahStok()">Tambah ke Stok</button>
  </section>

  <!-- Daftar Stok -->
  <section>
    <h3>ğŸ“¦ Stok Barang</h3>
    <input id="cariNamaBarang" placeholder="ğŸ” Cari Nama Barang" oninput="renderStok()" />
    <select id="filterKategori" onchange="renderStok()">
      <option value="">ğŸ“¦ Semua Kategori</option>
    </select>
    <button onclick="filterStokMenipis()">ğŸ” Tampilkan Stok Menipis</button>
    <button onclick="renderStok()">ğŸ” Tampilkan Semua</button>
    <button onclick="urutkanStokAZ()">ğŸ”¤ Urutkan A-Z</button>
    <table id="tabelStok">
	<div id="formEdit" style="display:none; margin-top:15px;">
	  <h4>âœï¸ Edit Barang</h4>
	  <input id="editNama" placeholder="Nama Barang" />
	  <select id="editKondisi">
	    <option>Baru</option>
	    <option>Bekas</option>
	  </select>
	  <input id="editHarga" placeholder="Harga Satuan" type="number" />
	  <input id="editJumlah" placeholder="Jumlah" type="number" />
	  <button onclick="simpanEdit()">ğŸ’¾ Simpan Perubahan</button>
	</div>
    </table>
  </section>

  <!-- Form Data Supir -->
  <section>
  <h3>ğŸš¹ Data Supir</h3>			   
    <input id="namaSupir" placeholder="Nama Supir" />
    <input id="nohpSupir" placeholder="No HP" />
    <input id="kendaraanSupir" placeholder="Kendaraan" />
    <button onclick="tambahSupir()">Tambah Supir</button>
    <table id="tabelSupir"></table>
  </section>

  <!-- Form Ambil Barang -->
  <section>
    <h3>ğŸ› ï¸ Supir Ambil Barang</h3>
    <select id="pilihBarang">
    </select>
    <input id="jumlahAmbil" placeholder="Jumlah Ambil" type="number" />
    <select id="inputSupir">
     <option value="">-- Pilih Supir --</option>
    </select>
    <button onclick="ambilBarang()">Ambil & Catat</button>
  </section>

  <!-- Log Pengeluaran -->
  <section>
    <h3>ğŸ“‹ Riwayat Pengeluaran</h3>
    <div style="margin-bottom:10px;">
      <input type="text" id="filterBarang" placeholder="ğŸ” Filter Nama Barang" oninput="renderLog()">
      <input type="date" id="filterTanggal"placeholder="DD/MM/YYYY" oninput="renderLog()">
    </div>
    <button onclick="exportExcel()">ğŸ“¥ Ekspor ke Excel</button>
    <table id="tabelLog"></table>
    <div id="totalPengeluaran">Total: Rp 0</div>
  </section>

  <section>
    <h3>ğŸ“Š Rekap Pengeluaran per Supir / Truk</h3>
    <button onclick="rekapPengeluaran()">ğŸ”„ Tampilkan Rekap</button>
    <button onclick="exportRekap()">ğŸ“¥ Ekspor Rekap ke Excel</button>
    <table id="tabelRekap"></table>
  </section>

  <section>
    <h3>ğŸ“ˆ Grafik Pengeluaran per Supir</h3>
    <canvas id="grafikSupir" height="100"></canvas>
      <label>Bulan:</label>
        <select id="filterBulan">
         <option value="">Semua</option>
           ${[...Array(12)].map((_, i) => `<option value="${(i+1).toString().padStart(2, '0')}">${(i+1).toString().padStart(2, '0')}</option>`).join('')}
        </select>

      <label>Tahun:</label>
        <select id="filterTahun">
         <option value="">Semua</option>
        </select>
    <button onclick="tampilkanGrafik()">ğŸ”„ Refresh Grafik</button>
  </section>

  <script src="script.js"></script>
</body>
</html>
